document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("#id-cash-modal");const a=new bootstrap.Modal(e);let d=null,r=void 0,t="";e.addEventListener("show.bs.modal",function(n){n.target.querySelector("form").reset(),Object.keys(n.relatedTarget.dataset).forEach(e=>{var t=e.endsWith("_readonly"),a=e.endsWith("_hide"),r=n.relatedTarget.dataset[e],e=(t&&(e=e.substring(0,e.length-9)),a&&(e=e.substring(0,e.length-5)),n.target.querySelector("."+e));if(e){if(a){a=e.closest(".parent-el");if(a)return void a.classList.add("d-none")}"value"in e?(e.value=r,t&&e.setAttribute("readonly","readonly")):e.innerText=r}}),r=n.relatedTarget.dataset.pk,t=n.relatedTarget.dataset.url||""}),e.addEventListener("hidden.bs.modal",function(e){var t;d&&(clearInterval(d),d=null),r?((t=new URL(window.location.href)).searchParams.set("hl",r),t.searchParams.delete("amount"),window.location.href=t.toString()):window.location.reload()}),document.querySelector("#id-cash-form").addEventListener("submit",function(n){n.preventDefault();var e=new FormData(n.target);Array.from(n.target.elements).forEach(e=>{e.disabled=!0,e.classList.contains("is-invalid")&&(e.classList.remove("is-invalid"),e.parentElement.querySelector(".invalid-feedback").remove())}),fetch(t,{method:"POST",headers:csrf_header(),body:e}).then(e=>e.json()).then(r=>{if(r.success){const alert=document.createElement("div"),t=(alert.classList.add("alert"),alert.classList.add("alert-success"),alert.innerText=r.message,n.target.parentElement.appendChild(alert),document.createElement("div"));t.classList.add("mt-3"),t.classList.add("text-center"),t.classList.add("f-5"),t.innerText="5",n.target.parentElement.appendChild(t);let e=4;d=setInterval(function(){t.innerText=e.toString(),--e<=0&&(clearInterval(d),a.hide())},1e3),void n.target.remove()}else Array.from(n.target.elements).forEach(e=>e.disabled=!1),"string"==typeof r.error?alert(r.error):Object.keys(r.error).forEach(e=>{var t=n.target.querySelector(`input[name="${e}"]`),a=(t.classList.add("is-invalid"),document.createElement("div"));a.classList.add("invalid-feedback"),a.innerText=r.error[e][0],t.parentElement.appendChild(a)})}).catch(e=>alert(e))})});