import{VideoRTC}from"./video-rtc.js";class VideoStream extends VideoRTC{set divMode(e){this.querySelector(".mode").innerText=e,this.querySelector(".status").innerText=""}set divError(e){"loading"===this.querySelector(".mode").innerText&&(this.querySelector(".mode").innerText="error",this.querySelector(".status").innerText=e)}oninit(){console.debug("stream.oninit"),super.oninit(),this.innerHTML=`
        <style>
        video-stream {
            position: relative;
        }
        .info {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 12px;
            color: white;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
        }
        </style>
        <div class="info">
            <div class="status"></div>
            <div class="mode"></div>
        </div>
        `;var e=this.querySelector(".info");this.insertBefore(this.video,e)}onconnect(){console.debug("stream.onconnect");var e=super.onconnect();return e&&(this.divMode="loading"),e}ondisconnect(){console.debug("stream.ondisconnect"),super.ondisconnect()}onopen(){console.debug("stream.onopen");var e=super.onopen();return this.onmessage.stream=e=>{switch(console.debug("stream.onmessge",e),e.type){case"error":this.divError=e.value;break;case"mse":case"hls":case"mp4":case"mjpeg":this.divMode=e.type.toUpperCase()}},e}onclose(){return console.debug("stream.onclose"),super.onclose()}onpcvideo(e){console.debug("stream.onpcvideo"),super.onpcvideo(e),this.pcState!==WebSocket.CLOSED&&(this.divMode="RTC")}}customElements.define("video-stream",VideoStream);